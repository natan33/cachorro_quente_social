$(document).ready(function(){const i=$("#salesTable").DataTable(),a={id:1,price:5};function n(){let o=parseInt($("#quantity").val())||1,e=a.price*o;$("#totalAmount").text(`R$ ${e.toFixed(2)}`)}$("#quantity").on("input change",n),$("#saleForm").on("submit",function(o){o.preventDefault();const e=parseInt($("#quantity").val());if(e<=0){alert("Quantidade deve ser maior que zero.");return}const s=$("#paymentMethod").val();if(!s){alert("Por favor, selecione o mÃ©todo de pagamento.");return}const l=$('input[name="payment_status"]:checked').val(),u={items:[{product_id:a.id,quantity:e}],payment_method:s,payment_status:l,notes:$("#notes").val()};$.ajax({url:"/sell",method:"POST",contentType:"application/json",data:JSON.stringify(u),success:function(t){if(alert(t.message),t.success){$("#quantity").val(1),$("#paymentMethod").val(""),$("#notes").val(""),$('input[name="payment_status"][value="not_paid"]').prop("checked",!0),n(),$("#registerSaleModal").modal("hide");const r=[t.sale_id,new Date().toLocaleString("pt-BR"),`R$ ${(a.price*e).toFixed(2)}`,s,"SeuUsuario",'<button class="btn btn-sm btn-info">Detalhes</button>'];i.row.add(r).draw(!1)}},error:function(t){const r=t.responseJSON?t.responseJSON.message:"Erro desconhecido.";alert("Erro ao registrar venda: "+r)}})}),n()});
